<launch>
	<arg name="ns" default="" />

	<!-- publish the robot -->
	<param name="tf_prefix" value="$(arg ns)" />
	<param name="robot_description" command="$(find xacro)/xacro.py $(find uh_simulation)/person_sim/urdf/person.xacro" />
	<node pkg="robot_state_publisher" type="state_publisher" name="robot_state_publisher">
		<param name="publish_frequency" type="double" value="15.0" />
	</node>

	<!-- combine front and rear scanner -->
	<node pkg="topic_tools" type="relay" name="scan_front_relay" args="scan_front scan_combined" />
	<node pkg="topic_tools" type="relay" name="scan_back_relay" args="scan_back scan_combined" />

	<!-- Run AMCL -->
	<node pkg="amcl" type="amcl" name="amcl" output="screen">
		<remap from="scan" to="scan_combined" />
		<remap from="map" to="/map" />
		<remap from="static_map" to="/static_map" />
		<rosparam file="$(find uh_simulation)/person_sim/config/amcl.yaml" command="load" />
		<param name="odom_frame_id" value="$(arg ns)/odom" />
		<param name="base_frame_id" value="$(arg ns)/base_link" />
	</node>

	<!-- move_base node -->
	<node pkg="move_base" type="move_base" respawn="false" name="move_base" output="screen">
		<remap from="map" to="/map" />
		<remap from="static_map" to="/static_map" />
		
		<rosparam file="$(find uh_simulation)/person_sim/config/navigation.yaml" command="load" />
		<rosparam file="$(find uh_simulation)/person_sim/config/local_planner.yaml" command="load" />

		<rosparam file="$(find uh_simulation)/person_sim/config/common_costmap.yaml" command="load" ns="local_costmap" />
		<rosparam file="$(find uh_simulation)/person_sim/config/local_costmap.yaml" command="load" ns="local_costmap" />

		<rosparam file="$(find uh_simulation)/person_sim/config/common_costmap.yaml" command="load" ns="global_costmap" />
		<rosparam file="$(find uh_simulation)/person_sim/config/global_costmap.yaml" command="load" ns="global_costmap" />
	</node>
</launch>